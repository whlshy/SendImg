import{j as e,b as he,r as b}from"./react-DXRKQaLJ.js";import{a as fe}from"./react-dom-C_Nl2RMt.js";import{c as O}from"./zustand-BtmBK-cH.js";import{B as $,S as ge,a as je,b as be,P as De,T as S,L as K,c as V,d as _,D as ye,e as I,I as W,C as we,f as G,E as ve,H as Ee,g as Ne,h as Ce,i as L,u as B,j as te,k as se,l as oe,m as Se,n as re,s as Ie,o as Ae}from"./@mui-BFZUKFpK.js";import{u as le,B as $e}from"./react-router-dom-CnjclEnD.js";import{a as U,b as ie,c as A,d as ce,u as Le}from"./react-router-DQGAB0dC.js";import{Q as Oe}from"./react-qr-code-AAIp8ll6.js";import{$ as X}from"./peerjs-DxFR7Coi.js";import{u as J,a as ae,b as ke}from"./jotai-cgJx3t6v.js";import{v as de}from"./uuid-C6aID195.js";import{Q as Pe,M as Re,a as Fe,b as Te}from"./@tanstack-r6gQdH2Z.js";import"./@babel-B_fy3T9z.js";import"./scheduler-C323NY8X.js";import"./clsx-B-dksMZM.js";import"./react-transition-group-CV_99lxT.js";import"./@emotion-uyX7IWDR.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./stylis-DDa9OTMq.js";import"./@popperjs-CMBiYTiD.js";import"./@remix-run-B5iXO-M-.js";import"./prop-types-Chjiymov.js";import"./qr.js-D7uXRtkb.js";import"./peerjs-js-binarypack-0qb93TeF.js";import"./webrtc-adapter-DzGuYBkV.js";import"./sdp-C8-99_ry.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))m(r);new MutationObserver(r=>{for(const x of r)if(x.type==="childList")for(const p of x.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&m(p)}).observe(document,{childList:!0,subtree:!0});function s(r){const x={};return r.integrity&&(x.integrity=r.integrity),r.referrerPolicy&&(x.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?x.credentials="include":r.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function m(r){if(r.ep)return;r.ep=!0;const x=s(r);fetch(r.href,x)}})();const k=t=>(l,s,m)=>t((...r)=>{console.log("  applying",r),l(...r),console.log("  new state",s())},s,m),Y={open:!1,message:null,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,status:null},H=O(k((t,l)=>({...Y,setSnackMsg:s=>t({...s,open:!0}),closeSnackbar:()=>t(Y)})));function Be(t){return e.jsx(be,{...t,direction:"down"})}function Me(t){const{snackbar:l,closeSnackbar:s,message:m,open:r,anchorOrigin:x,autoHideDuration:p,status:n}=H(h=>h),u=e.jsx(he.Fragment,{children:e.jsx($,{color:"inherit",size:"small",onClick:s,children:"確認"})}),c=h=>{switch(h){case 401:return"沒有權限！";case 500:return"API發生未知錯誤！"}};return e.jsx(ge,{open:r,onClose:s,anchorOrigin:x,TransitionComponent:Be,autoHideDuration:p,children:e.jsx("div",{className:"rainbow",children:e.jsx("div",{className:"rainbow-container",children:e.jsx(je,{message:n!=null?c(n):m,action:u})})})})}const Ue={mid:null,name:"訪客",account:null,email:null,sso:null,lastLoginDT:null,isLogin:null,refetch:null};O(k((t,l)=>({...Ue,setAccount:s=>t({...s,isLogin:!((s==null?void 0:s.mid)==0||!(s!=null&&s.mid))})})));const Z={open:!1,title:"",content:"",handleAgree:()=>{},handleDisagree:()=>{}},He=O(k((t,l)=>({...Z,setAlert:s=>t({...Z,...s,open:!0}),closeAlert:()=>t({open:!1})}))),We={isSidebarOpen:!0},Je=O(k((t,l)=>({...We,setSidebarOpen:(s=null)=>t(m=>({isSidebarOpen:s!==null?s:!m.isSidebarOpen}))}))),q={open:!1,title:"",content:null,actions:null,body:null},ze=O(k((t,l)=>({...q,setDialog:s=>t({...q,...s,open:!0}),closeDialog:()=>t({open:!1})})));function Qe(){const t=U();return e.jsxs("div",{className:"min-h-screen bg-[#0D1117] text-[#C9D1D9] flex flex-col items-center justify-center px-4",children:[e.jsx("h1",{className:"text-3xl font-semibold mb-8",children:"📸 WHL 圖片傳輸工具"}),e.jsx("button",{className:"w-full max-w-xs bg-[#238636] hover:bg-[#2EA043] text-white py-3 rounded-lg mb-4 transition",onClick:()=>t("/create"),children:"建立連線"}),e.jsx("button",{className:"w-full max-w-xs bg-[#161B22] hover:bg-[#30363D] text-[#C9D1D9] py-3 rounded-lg transition",onClick:()=>t("/join"),children:"加入連線"})]})}const j={SELECTED:"selected",SENDING:"sending",SENT:"sent",FAILED:"failed",RECEIVED:"received",DOWNLOADED:"downloaded"},me=ae(!1);function Ke({roomId:t,isHost:l}){const[s,m]=b.useState(null),[r,x]=J(me),p=b.useRef(null),[n,u]=b.useState([]),[c,h]=b.useState([]),f=b.useRef({}),{setSnackMsg:D}=H();b.useEffect(()=>{let o;if(t)return l?(o=new X(t),console.log(`Host attempting to open Peer with ID: ${t}`)):(o=new X(void 0),console.log("Joiner attempting to open Peer with a random ID")),m(o),()=>{o&&!(o!=null&&o.destroyed)&&(console.log("Destroying peer instance:",o.id),o.destroy()),m(null),u([]),h([])}},[t,l]),b.useEffect(()=>{if(!s)return;s.removeAllListeners();const o=i=>console.error("PeerJS error:",i);s.on("error",o);const a=i=>{p.current=i,i.on("open",()=>{x(!0),console.log(`DataConnection open with ${i.peer}`)}),i.on("close",()=>{x(!1),p.current=null,console.log(`DataConnection closed with ${i.peer}`)}),i.on("error",d=>{console.error(`DataConnection error with ${i.peer}:`,d),x(!1)}),i.on("data",d=>{if(l)d.type==="file-received-ack"?(console.log(`Host: ACK for file ${d.fileId}`),u(g=>g.map(E=>E.id===d.fileId?{...E,status:j.SENT}:E))):d.type==="file-receive-error"&&(console.error(`Host: Joiner reported error for file ${d.fileId}: ${d.error}`),u(g=>g.map(E=>E.id===d.fileId?{...E,status:j.FAILED}:E)));else if(console.log("blob in",d),d.type==="file-metadata")console.log("Joiner: Received file metadata",d),f.current[d.fileId]=d;else if(d instanceof Blob||d instanceof ArrayBuffer||d instanceof Uint8Array){let g=null;const E=Object.keys(f.current).filter(N=>!c.some(T=>T.id===N));if(E.length>0){const N=E[E.length-1];N&&f.current[N]&&(g=f.current[N])}if(g){const{fileId:N,name:T,mimeType:z,size:ue}=g;console.log(`Joiner: Received blob for ${T} (ID: ${N})`);const Q=d instanceof Blob?d:new Blob([d],{type:z}),xe=URL.createObjectURL(Q);h(pe=>[...pe,{id:N,name:T,type:z,size:ue,blobUrl:xe,blobObject:Q,status:j.RECEIVED}]),i.send({type:"file-received-ack",fileId:N}),delete f.current[N]}else console.warn("Joiner: Received blob/arraybuffer without matching metadata or ID.")}else d.type==="batch-meta"&&console.log("Joiner: Received batch metadata",d)})};l?(s.on("open",i=>console.log(`Host Peer opened: ${i}`)),s.on("connection",a)):s.on("open",i=>{if(console.log(`Joiner Peer opened: ${i}`),t){const d=s.connect(t);a(d)}})},[s,t,l,c]);const y=o=>{const a=Array.from(o.target.files).map(i=>({id:de(),name:i.name,size:i.size,type:i.type,previewUrl:URL.createObjectURL(i),status:j.SELECTED,fileObject:i}));u(i=>[...i,...a]),o.target.value=null},v=async()=>{if(!r||!p.current){alert("連線未建立!");return}const o=n.filter(a=>a.status===j.SELECTED);if(o.length===0){alert("沒有已選擇的檔案可傳送。");return}p.current.send({type:"batch-meta",totalFiles:o.length});for(const a of o){u(i=>i.map(d=>d.id===a.id?{...d,status:j.SENDING}:d));try{const i={type:"file-metadata",fileId:a.id,name:a.name,mimeType:a.type,size:a.size};p.current.send(i)}catch(i){console.error(`Host: Error sending file ${a.name}:`,i),u(d=>d.map(g=>g.id===a.id?{...g,status:j.FAILED}:g))}}for(const a of o)try{await new Promise(i=>setTimeout(i,50)),p.current.send(a.fileObject),console.log(`Host: Sent ${a.name} (ID: ${a.id})`)}catch(i){console.error(`Host: Error sending file ${a.name}:`,i),u(d=>d.map(g=>g.id===a.id?{...g,status:j.FAILED}:g))}},w=o=>{const a=c.find(i=>i.id===o);if(a){const i=document.createElement("a");i.href=a.blobUrl,i.download=a.name,document.body.appendChild(i),i.click(),document.body.removeChild(i),h(d=>d.map(g=>g.id===o?{...g,status:j.DOWNLOADED}:g))}},C=async()=>{const o=c.filter(a=>a.status===j.RECEIVED&&a.blobUrl);if(o.length===0){D({message:"沒有可下載的新檔案。"});return}for(let a=0;a<o.length;a++){const i=o[a];console.log(`Auto-downloading ${a+1}/${o.length}: ${i.name}`),w(i.id),a<o.length-1&&await new Promise(d=>setTimeout(d,500))}D({message:`${o.length} 個檔案已開始下載。`})},P=c.some(o=>o.status===j.RECEIVED&&o.blobUrl),R=o=>{const a=n.filter(i=>i.id!==o);u(a)},F=(o,a=null)=>{switch(o){case j.SELECTED:return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:"已選擇",children:e.jsx(Ne,{color:"action"})}),e.jsx(I,{title:"刪除",children:e.jsx(W,{sx:{ml:1},onClick:()=>R(a),children:e.jsx(Ce,{color:"action"})})})]});case j.SENDING:return e.jsx(I,{title:"傳送中",children:e.jsx(Ee,{color:"primary",className:"animate-spin"})});case j.SENT:return e.jsx(I,{title:"已傳送",children:e.jsx(G,{color:"success"})});case j.FAILED:return e.jsx(I,{title:"失敗",children:e.jsx(ve,{color:"error"})});default:return null}};return e.jsx("div",{children:e.jsx(ie,{children:e.jsx(A,{path:"/transfer",element:e.jsxs(De,{elevation:3,className:"p-4 md:p-6 max-w-2xl mx-auto my-4",children:[e.jsxs(S,{variant:"h5",component:"h2",gutterBottom:!0,className:"text-center text-indigo-600",children:["WHL's 檔案傳輸 (",l?"Host":"Joiner",")"]}),e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsxs(S,{children:["Peer ID: ",e.jsx("span",{className:"font-mono bg-gray-100 p-1 rounded",children:(s==null?void 0:s.id)||"..."})]}),l&&e.jsxs(S,{children:["房號: ",e.jsx("span",{className:"font-mono bg-gray-100 p-1 rounded",children:t})]}),e.jsxs(S,{children:["連線狀態:",e.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full text-white ${r?"bg-green-500":"bg-red-500"}`,children:r?"已連線":"未連線"})]})]}),l&&e.jsxs("div",{className:"mt-6 border-t pt-4",children:[e.jsx(S,{variant:"h6",gutterBottom:!0,children:"傳送檔案"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs($,{variant:"outlined",component:"label",disabled:!r,children:["選擇檔案",e.jsx("input",{type:"file",hidden:!0,multiple:!0,onChange:y})]}),e.jsx($,{variant:"contained",color:"primary",onClick:v,disabled:!r||!n.some(o=>o.status===j.SELECTED),sx:{ml:2},className:"ml-2",children:"傳送已選擇的"})]}),n.length>0&&e.jsx(K,{dense:!0,children:n.map(o=>e.jsxs(V,{divider:!0,className:"hover:bg-gray-50",children:[e.jsx("img",{src:o.previewUrl,alt:o.name,className:"w-12 h-12 object-cover mr-3 rounded"}),e.jsx(_,{primary:e.jsx("span",{className:"font-medium",children:o.name}),secondary:`${(o.size/1024).toFixed(1)} KB - 狀態: ${o.status}`}),e.jsx("div",{className:"ml-auto",children:F(o.status,o.id)})]},o.id))})]}),!l&&e.jsxs("div",{className:"mt-6 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs(S,{variant:"h6",gutterBottom:!0,component:"div",children:[" ","接收到的檔案"]}),c.length>0&&e.jsx($,{variant:"contained",size:"small",startIcon:e.jsx(ye,{}),onClick:C,disabled:!P||!r,className:"bg-teal-500 hover:bg-teal-700 disabled:bg-gray-300",children:"下載全部未下載"})]}),c.length===0&&r&&e.jsx(S,{variant:"body2",color:"textSecondary",children:"等待接收檔案中..."}),c.length===0&&!r&&e.jsx(S,{variant:"body2",color:"textSecondary",children:"請先連線至 Host。"}),c.length>0&&e.jsx(K,{dense:!0,children:c.map(o=>e.jsxs(V,{divider:!0,className:"hover:bg-gray-50",children:[e.jsx("img",{src:o.blobUrl,alt:o.name,className:"w-12 h-12 object-cover mr-3 rounded"}),e.jsx(_,{primary:e.jsx("span",{className:"font-medium",children:o.name}),secondary:`${(o.size/1024).toFixed(1)} KB`}),e.jsx(I,{title:"下載檔案",children:e.jsx(W,{color:"primary",onClick:()=>w(o.id),disabled:o.status===j.DOWNLOADED,children:e.jsx(we,{})})}),o.status===j.DOWNLOADED&&e.jsx(I,{title:"已下載",children:e.jsx(G,{color:"success",className:"ml-2"})})]},o.id))})]})]})})})})}function Ve(){const[t,l]=le(),s=t.get("roomId"),m=U(),[r,x]=b.useState(""),{setSnackMsg:p}=H(),[n,u]=J(me);b.useEffect(()=>{const f=de().slice(0,13);l({roomId:f,isHost:!0});const D=window.location.origin;x(`${D}/SendImg/join/${f}`)},[]),b.useEffect(()=>{n&&m(`/transfer?roomId=${s}&isHost=true`)},[n]);const c=()=>{r&&navigator.clipboard.writeText(r).then(()=>{p({message:"已複製加入連結到剪貼簿！"})})},h=()=>{m("/")};return e.jsxs("div",{className:"min-h-screen bg-[#0D1117] text-[#C9D1D9] flex flex-col items-center justify-center px-4",children:[e.jsx("h2",{className:"text-2xl font-medium mb-6",children:"🆔 你的房間 ID"}),e.jsxs("div",{className:"bg-[#161B22] p-6 rounded-lg flex flex-col items-center",children:[e.jsx("p",{className:"text-xl font-mono mb-4",children:s}),r&&e.jsxs("div",{className:"w-full mb-4",children:[e.jsx("label",{className:"block text-sm text-[#8B949E] mb-1",children:"加入連結"}),e.jsxs("div",{className:"flex items-center bg-[#0D1117] rounded-lg overflow-hidden",children:[e.jsx("input",{type:"text",readOnly:!0,value:r,className:"flex-1 px-3 py-2 bg-transparent text-[#C9D1D9] font-mono focus:outline-none"}),e.jsx("button",{onClick:c,className:"px-3 py-2 bg-[#238636] hover:bg-[#2EA043] text-white transition",children:"複製"})]})]}),r&&e.jsx("div",{className:"bg-white p-2 rounded-md mb-4",children:e.jsx(Oe,{value:r,size:128})}),e.jsx("p",{className:"text-sm text-[#8B949E]",children:"等待對方掃描或點選連結加入…⏳"})]}),e.jsx("button",{className:"mt-8 bg-[#161B22] hover:bg-[#30363D] text-[#C9D1D9] px-6 py-2 rounded-lg transition",onClick:h,children:"← 返回"})]})}function ee(){const t=U(),{roomId:l}=ce(),[s,m]=b.useState("");b.useEffect(()=>{l&&t(`/transfer?roomId=${l}`)},[l,t]);const r=()=>{const p=s.trim();p.length!==0&&t(`/transfer?roomId=${p}`)},x=()=>{t("/")};return l?e.jsx("div",{className:"min-h-screen bg-[#0D1117] text-[#C9D1D9] flex items-center justify-center",children:e.jsx("p",{className:"text-lg",children:"自動導向中…"})}):e.jsxs("div",{className:"min-h-screen bg-[#0D1117] text-[#C9D1D9] flex flex-col items-center justify-center px-4",children:[e.jsx("h2",{className:"text-2xl font-medium mb-6",children:"🔗 加入房間"}),e.jsxs("div",{className:"w-full max-w-xs",children:[e.jsx("label",{className:"block text-[#8B949E] mb-2",htmlFor:"roomId",children:"房間 ID"}),e.jsx("input",{id:"roomId",type:"text",value:s,onChange:p=>m(p.target.value),className:"w-full px-4 py-2 bg-[#161B22] text-[#C9D1D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#238636] mb-4",placeholder:"輸入房間 ID..."}),e.jsx("button",{className:"w-full bg-[#238636] hover:bg-[#2EA043] text-white py-3 rounded-lg transition mb-4",onClick:r,children:"加入"}),e.jsx("button",{className:"w-full bg-[#161B22] hover:bg-[#30363D] text-[#C9D1D9] py-3 rounded-lg transition",onClick:x,children:"← 返回"})]})]})}function _e(){var r;const{roomId:t}=ce(),l=Le(),s=U();(r=l.state)==null||r.isHost;const m=()=>{s("/")};return e.jsx("div",{className:"bg-[#0D1117] text-[#C9D1D9] flex flex-col items-center px-4 py-6",children:e.jsx("button",{className:"mt-auto bg-[#161B22] hover:bg-[#30363D] text-[#C9D1D9] px-6 py-2 rounded-lg transition",onClick:m,children:"← 離開房間"})})}function Ge(){const[t,l]=le(),s=t.get("roomId"),m=t.get("isHost");return e.jsxs(L,{sx:{flex:"1 1 auto"},children:[e.jsx(Ke,{roomId:s,isHost:m}),e.jsxs(ie,{children:[e.jsx(A,{path:"/",element:e.jsx(Qe,{})}),e.jsx(A,{path:"/create",element:e.jsx(Ve,{})}),e.jsx(A,{path:"/join/:roomId",element:e.jsx(ee,{})}),e.jsx(A,{path:"/join",element:e.jsx(ee,{})}),e.jsx(A,{path:"/transfer",element:e.jsx(_e,{})})]})]})}function Xe(t){const{title:l}=t;return e.jsx("footer",{children:e.jsx("div",{className:"footer-content footer-info flex aic",children:e.jsx("div",{className:"flex rowTitle",children:"© 2025 WHL. All rights reserved."})})})}function Ye(){return B("(min-width:900px)"),e.jsx(L,{sx:{display:"flex",height:"100%",width:"100%"},children:e.jsxs(L,{component:"main",sx:{flexGrow:1,p:0,display:"flex",flexDirection:"column"},children:[e.jsx(Ge,{}),e.jsx(Xe,{title:null})]})})}function Ze(){const{open:t,closeAlert:l,title:s,content:m,handleAgree:r,handleDisagree:x}=He(p=>p);return e.jsxs(te,{open:t,onClose:l,children:[e.jsx(se,{children:s}),e.jsx(oe,{children:e.jsx(Se,{sx:{whiteSpace:"pre-line"},children:m})}),e.jsxs(re,{children:[e.jsx($,{onClick:l,children:"取消"}),e.jsx($,{onClick:()=>r(l),autoFocus:!0,children:"確認"})]})]})}function qe(t){var w;const{children:l,margin:s=15,sx:m={},content_sx:r={},data:x=null,onlyProps:p=!1,noDrawer:n=!1}=t,u=((w=Je())==null?void 0:w.isDrawerOpen)&&!n,c=B(u?"(min-width:1440px)":"(min-width:1200px)"),h=B(u?"(min-width:1232px)":"(min-width:992px)"),f=B(u?"(min-width:1008px)":"(min-width:768px)");let D=c?"1170px":h?"970px":f?"750px":"100%",y=(x==null?void 0:x.length)<3?`${100/x.length}%`:c?1170/3:h?970/3:f?750/2:D;const v={content_width:D,margin:`${s}px`,width:y,width_margin:typeof y!="string"?y-s*2:`calc(${y} - ${s*2}px)`,lg:c,md:h,xs:f};return p==!0?e.jsx(b.Fragment,{children:b.cloneElement(l,{...v})}):e.jsx(L,{className:"flex flex-1-1 jcsb flex-col aic",sx:{...m},children:e.jsx(L,{sx:{width:D,display:"flex",flexWrap:"wrap",...r},children:b.cloneElement(l,{...v})})})}const en=Ie(te)(({theme:t})=>({"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}));function nn(t){const{isRwdWidth:l}=t;return l?e.jsx(qe,{onlyProps:!0,noDrawer:!0,children:e.jsx(ne,{...t})}):e.jsx(ne,{...t})}const ne=t=>{const{content_width:l,open:s,title:m,content:r,actions:x,body:p,closeDialog:n,disableScrollLock:u,fullWidth:c,fullHeight:h,maxWidth:f,fullScreen:D,isRwdWidth:y,contentProps:v={}}=t,w=y?{sx:{width:"100%",maxWidth:`${l} !important`,height:h?"100%":"auto"}}:{fullWidth:c,maxWidth:f,fullScreen:D};return e.jsxs(en,{onClose:n,open:s,disableScrollLock:!!u,...y?{}:w,PaperProps:{...y?w:{}},children:[e.jsxs(L,{className:"flex aic jcsb",sx:{p:1},children:[e.jsx(se,{sx:{m:0,p:0,pl:1},children:m}),e.jsx(W,{onClick:n,sx:{color:C=>C.palette.grey[500]},children:e.jsx(Ae,{})})]}),p?b.cloneElement(p,{closeDialog:n}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{dividers:!0,sx:{...v},children:!!r&&b.cloneElement(r,{closeDialog:n})}),!!x&&e.jsx(re,{children:b.cloneElement(x,{closeDialog:n})})]})]})},tn=()=>{const{...t}=ze();return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{}),e.jsx(Ze,{}),e.jsx(Me,{}),e.jsx(nn,{...t})]})},sn={},M=ae(sn,async(t,l,s)=>{let m=t(M);l(M,{...m,...s})}),on=()=>{const[{...t},l]=J(M),s=({key:m,body:r})=>{console.log(`apiDataAtom log (${m}):`,{...t,[m]:r}),l({[m]:r})};return{...ke(M),setApiData:s}},rn=()=>{const{setSnackMsg:t}=H(n=>n),{setApiData:l}=on(),s=(n=[])=>{let u="";n==null||n.map((c,h)=>{u+=(h==0?"":`

`)+((c==null?void 0:c.displayName)||(c==null?void 0:c.field))+`：
`+(c==null?void 0:c.error)}),setAlert({title:"錯誤",content:u,handleAgree:c=>c()})},m=(n,u,c)=>{console.log("onError",n,u),t({message:"API發生未知錯誤"})},r=async(n,u)=>{var h,f,D,y,v,w,C,P,R,F,o;((f=(h=u==null?void 0:u.queryKey)==null?void 0:h[0])==null?void 0:f[0])=="_"&&l({key:(y=(D=u==null?void 0:u.queryKey)==null?void 0:D[0])==null?void 0:y.replace("_",""),body:{data:n==null?void 0:n.body,refetch:(v=u==null?void 0:u.options)==null?void 0:v.queryFn}});const c=((w=n==null?void 0:n.body)==null?void 0:w.status)!==null&&((C=n==null?void 0:n.body)==null?void 0:C.status)!==void 0?(P=n==null?void 0:n.body)==null?void 0:P.status:null;c!==null&&Array.isArray((R=n==null?void 0:n.body)==null?void 0:R.errorArray)?s((F=n==null?void 0:n.body)==null?void 0:F.errorArray):c!==null&&t({message:(o=n==null?void 0:n.body)==null?void 0:o.message}),!(n!=null&&n.ok)&&c==null&&!(n!=null&&n.pages)&&t({message:"API發生未知錯誤！"})},x=(n,u)=>{},p=new Pe({queryCache:new Fe({onSuccess:r,onError:m,onSettled:x}),mutationCache:new Re({onSuccess:r,onError:m}),defaultOptions:{queries:{refetchOnWindowFocus:!1,select:n=>{var h,f,D,y;let c=(((h=n==null?void 0:n.body)==null?void 0:h.status)!==null&&((f=n==null?void 0:n.body)==null?void 0:f.status)!==void 0?(D=n==null?void 0:n.body)==null?void 0:D.status:null)==null&&n.body||null;if(Array.isArray(n==null?void 0:n.pages)){let v=[];(y=n==null?void 0:n.pages)==null||y.map((w,C)=>{v[C]=(w==null?void 0:w.body)||w}),c={...n,pages:v}}return c}}}});return e.jsx(Te,{client:p,children:e.jsx($e,{basename:"/SendImg/",children:e.jsx(tn,{})})})},ln=document.getElementById("root");fe.createRoot(ln).render(e.jsx(rn,{}));
